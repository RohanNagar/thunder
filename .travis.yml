language: java
jdk:
  - oraclejdk8

addons:
  apt:
    packages:
    - npm

install:
  - mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
  - npm --prefix scripts/ install

script:
  - mvn clean package jacoco:report coveralls:report
  - java -jar application/target/application-*.jar server test-config.yaml &
  - node scripts/src/test-runner.js

# Restrict branch builds to master
branches:
  only:
    - master

env:
  - AWS_ACCESS_KEY_ID=1234567890
  - AWS_SECRET_ACCESS_KEY=1234567890
